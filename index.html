<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeu de la Vie</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        #game {
            display: grid;
            grid-template-columns: repeat(50, 10px);
            grid-template-rows: repeat(50, 10px);
            gap: 1px;
            margin-bottom: 20px;
            user-select: none; /* Empêche la sélection de texte lors du glissement */
        }
        .cell {
            width: 10px;
            height: 10px;
            background-color: #fff;
            border: 1px solid #ddd;
            cursor: pointer;
        }
        .alive {
            background-color: #000;
        }
        #controls {
            display: flex;
            gap: 10px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div id="game"></div>
    <div id="controls">
        <button id="startPauseButton">Démarrer</button>
        <button id="clearButton">Effacer</button>
    </div>

    <script>
        const rows = 50;
        const cols = 50;
        const gameElement = document.getElementById('game');
        const startPauseButton = document.getElementById('startPauseButton');
        const clearButton = document.getElementById('clearButton');
        let grid = Array.from({ length: rows }, () => Array(cols).fill(0));
        let running = false;
        let intervalId;

        let isMouseDown = false;
        let toggleState = 1; // 1 pour activer, 0 pour désactiver

        // Créer la grille dans le DOM
        for (let row = 0; row < rows; row++) {
            for (let col = 0; col < cols; col++) {
                const cellElement = document.createElement('div');
                cellElement.classList.add('cell');
                
                // Événements pour cliquer et glisser
                cellElement.addEventListener('mousedown', (e) => {
                    e.preventDefault(); // Empêche la sélection de texte
                    isMouseDown = true;
                    toggleState = grid[row][col] ? 0 : 1;
                    grid[row][col] = toggleState;
                    cellElement.classList.toggle('alive', toggleState === 1);
                });

                cellElement.addEventListener('mouseover', () => {
                    if (isMouseDown) {
                        grid[row][col] = toggleState;
                        cellElement.classList.toggle('alive', toggleState === 1);
                    }
                });

                cellElement.addEventListener('mouseup', () => {
                    isMouseDown = false;
                });

                gameElement.appendChild(cellElement);
            }
        }

        // Empêche le comportement par défaut du navigateur lors du glissement en dehors de la grille
        document.body.addEventListener('mouseup', () => {
            isMouseDown = false;
        });

        // Placement automatique des motifs au démarrage
        function placeInitialPattern() {
            // Exemple de placement d'un oscillateur (ligne de 3 cellules)
            const oscillator = [
                [10, 10],
                [10, 11],
                [10, 12]
            ];

            oscillator.forEach(([row, col]) => {
                if (row < rows && col < cols) {
                    grid[row][col] = 1;
                }
            });

            // Exemple de placement d'un vaisseau léger
            const glider = [
                [20, 20],
                [21, 21],
                [22, 19],
                [22, 20],
                [22, 21]
            ];

            glider.forEach(([row, col]) => {
                if (row < rows && col < cols) {
                    grid[row][col] = 1;
                }
            });

            updateDOM();
        }

        // Mettre à jour la grille dans le DOM
        function updateDOM() {
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    const cellElement = getCellElement(row, col);
                    if (grid[row][col] === 1) {
                        cellElement.classList.add('alive');
                    } else {
                        cellElement.classList.remove('alive');
                    }
                }
            }
        }

        // Obtenir la position d'une cellule dans la grille
        function getCellElement(row, col) {
            return gameElement.children[row * cols + col];
        }

        // Appliquer les règles du jeu de la vie
        function updateGridFunction() {
            let newGrid = grid.map(arr => [...arr]);

            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    const neighbors = countNeighbors(row, col);
                    if (grid[row][col] === 1) {
                        if (neighbors < 2 || neighbors > 3) {
                            newGrid[row][col] = 0;
                        }
                    } else {
                        if (neighbors === 3) {
                            newGrid[row][col] = 1;
                        }
                    }
                }
            }

            // Mettre à jour la grille et le DOM
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    if (grid[row][col] !== newGrid[row][col]) {
                        grid[row][col] = newGrid[row][col];
                        const cellElement = getCellElement(row, col);
                        if (grid[row][col] === 1) {
                            cellElement.classList.add('alive');
                        } else {
                            cellElement.classList.remove('alive');
                        }
                    }
                }
            }
        }

        // Compter les voisins vivants autour d'une cellule
        function countNeighbors(row, col) {
            let count = 0;
            for (let i = -1; i <= 1; i++) {
                for (let j = -1; j <= 1; j++) {
                    if (i === 0 && j === 0) continue;
                    const x = (row + i + rows) % rows;
                    const y = (col + j + cols) % cols;
                    count += grid[x][y];
                }
            }
            return count;
        }

        // Démarrer ou mettre en pause la simulation
        function startPauseGame() {
            if (!running) {
                intervalId = setInterval(updateGridFunction, 100);
                running = true;
                startPauseButton.textContent = 'Pause';
            } else {
                clearInterval(intervalId);
                running = false;
                startPauseButton.textContent = 'Démarrer';
            }
        }

        // Effacer la grille
        function clearGridFunction() {
            clearInterval(intervalId);
            running = false;
            startPauseButton.textContent = 'Démarrer';
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    grid[row][col] = 0;
                    const cellElement = getCellElement(row, col);
                    cellElement.classList.remove('alive');
                }
            }
        }

        // Ajouter des écouteurs d'événements aux boutons
        startPauseButton.addEventListener('click', startPauseGame);
        clearButton.addEventListener('click', clearGridFunction);

        // Placer les motifs initiaux et mettre à jour la grille
        placeInitialPattern();
    </script>

</body>
</html>
